name: PHP-Prefixer for 6.x

on:
  workflow_dispatch:
  schedule:
    - cron:  '15 10 * * 6'

jobs:
  main:
    runs-on: ubuntu-latest

    steps:
      - name: Run PHP-Prefixer
        uses: PHP-Prefixer/php-prefixer-build-action@v1.1.0
        with:
          personal_access_token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
          project_id: ${{ secrets.PROJECT_ID }}
          token: ${{ secrets.GH_PERSONAL_ACCESS_TOKEN }}
          repository: 'illuminate/support'
          ref: '6.x'
          schema: >
            {"project-name": "Prefixed Project","namespaces-prefix": "PPP","global-scope-prefix": "PPP_"}
      - uses: actions/checkout@v2
        with:
          ref: 'prefixed-6.x'
          fetch-depth: 0
      - name: Composer Search and Replace name
        uses: jossef/action-set-json-field@v1
        with:
          file: composer.json
          field: name
          value: php-prefixer/prefixed-illuminate-support
      - name: Composer Search and Replace description
        uses: jossef/action-set-json-field@v1
        with:
          file: composer.json
          field: description
          value: The Prefixed Illuminate Support package.
      - name: Composer Search and Replace description
        uses: jossef/action-set-json-field@v1
        with:
          file: composer.json
          field: homepage
          value: https://php-prefixer.com
      - name: Composer Search and Replace authors.name
        uses: jossef/action-set-json-field@v1
        with:
          file: composer.json
          field: authors.name
          value: Anibal Sanchez
      - name: Composer Search and Replace authors.email
        uses: jossef/action-set-json-field@v1
        with:
          file: composer.json
          field: authors.email
          value: anibal.sanchez@php-prefixer.com